<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="Abnerzhao"><meta name="description" content="#!标记大部分.py文件不必以#!作为文件的开始。程序的main文件应该以#!/usr/bin/python2或者#!/usr/bin/python3开始。(#!先用于帮助内核找到Python解释器,但是在导入模块时,将会被忽略。因此只有被直接执行的文件中才有必要加"><meta name="keywords" content="Python"><title>Python编码风格 · Abner</title><link rel="icon" href="/favicon.ico"><link rel="canonical" href="http://yoursite.com/2016/10/29/Python编码风格/"><link rel="alternate" href="/atom.xml" title="Abner"><link rel="stylesheet" href="/fonts/iconfont/iconfont.css"><link rel="stylesheet" href="/css/style.css"><script type="text/javascript">var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?5832f612aff8681e2ee213a3b8d9548b";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script type="text/javascript">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'Your Google Analytics ID', 'auto');
ga('send', 'pageview');</script></head><body><div id="main"><header><a href="/." class="logo">Abner</a><ul class="nav"><li class="nav-link"><a href="/" target="_self">Home</a></li><li class="nav-link"><a href="/archives/" target="_self">Archives</a></li><li class="nav-link"><a href="/tags/" target="_self">Tags</a></li><li class="nav-link"><a href="/about/" target="_self">About</a></li></ul></header><section id="container"><article class="post"><h1 class="post-title">Python编码风格</h1><span class="post-time">Oct 29, 2016</span><div id="sidebar" class="post-sidebar"><h3 class="heading">Contents</h3><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#标记"><span class="toc-text">#!标记</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#分号"><span class="toc-text">分号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#行长度"><span class="toc-text">行长度</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#例外："><span class="toc-text">例外：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#括号"><span class="toc-text">括号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#缩进"><span class="toc-text">缩进</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#空行"><span class="toc-text">空行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#注释"><span class="toc-text">注释</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#类"><span class="toc-text">类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#字符串"><span class="toc-text">字符串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#文件和sockets"><span class="toc-text">文件和sockets</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TODO注释"><span class="toc-text">TODO注释</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#导入格式"><span class="toc-text">导入格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#语句"><span class="toc-text">语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#访问控制"><span class="toc-text">访问控制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#命名"><span class="toc-text">命名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Main"><span class="toc-text">Main</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#参考"><span class="toc-text">参考</span></a></li></ol></div><div class="post-content"><h3 id="标记"><a href="#标记" class="headerlink" title="#!标记"></a>#!标记</h3><blockquote>
<p>大部分.py文件不必以#!作为文件的开始。 程序的main文件应该以 #!/usr/bin/python2或者 #!/usr/bin/python3开始。 (<code>#!先用于帮助内核找到Python解释器, 但是在导入模块时, 将会被忽略。因此只有被直接执行的文件中才有必要加入#!</code>)</p>
</blockquote>
<h3 id="分号"><a href="#分号" class="headerlink" title="分号"></a>分号</h3><blockquote>
<p>不要在行尾加分号, 也不要用分号将两条命令放在同一行.</p>
</blockquote>
<h3 id="行长度"><a href="#行长度" class="headerlink" title="行长度"></a>行长度</h3><blockquote>
<p>每行不超过80个字符</p>
</blockquote>
<h4 id="例外："><a href="#例外：" class="headerlink" title="例外："></a>例外：</h4><ul>
<li>长的导入模块语句</li>
<li>注释里的URL</li>
</ul>
<p>Python会将<code>圆括号、中括号和花括号</code>中的行隐式的连接起来，不要使用反斜杠连接行</p>
<p>如果一个文本字符串在一行放不下, 可以使用圆括号来实现隐式行连接:</p>
<pre><code>long_str = (&apos;This will build a very long long&apos;
            &apos;long long long long long long string&apos;)                                 
</code></pre><h3 id="括号"><a href="#括号" class="headerlink" title="括号"></a>括号</h3><blockquote>
<p>尽量少使用括号，除非实现隐式行，不要在返回语句或条件语句中使用括号，在元组两边可以使用括号</p>
</blockquote>
<h3 id="缩进"><a href="#缩进" class="headerlink" title="缩进"></a>缩进</h3><blockquote>
<p>用4个空格来缩进代码</p>
</blockquote>
<h3 id="空行"><a href="#空行" class="headerlink" title="空行"></a>空行</h3><ul>
<li>顶级定义（类和函数）之间空两行, 方法定义之间空一行</li>
<li>括号内不要有空格</li>
<li>逗号, 分号, 冒号前面不要加空格，应该在它们后面加(除了在行尾)</li>
<li>参数列表, 索引或切片的左括号前不应加空格</li>
<li>在二元操作符两边都加上一个空格, 比如赋值<code>(=，==， &lt;， &gt;， !=， &lt;&gt;， &lt;=， &gt;=，in， not in， is， is not)， 布尔(and， or， not)</code></li>
<li>当’=’用于指示关键字参数或默认参数值时, 不要在其两侧使用空格</li>
<li>不要用空格来垂直对齐多行间的标记，这会成为维护的负担(适用于:, #, =等)</li>
</ul>
<h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><ul>
<li>文档字符串</li>
</ul>
<blockquote>
<p>使用三重双引号”””(一个文档字符串应该这样组织: 首先是一行以句号，问号或惊叹号结尾的概述(或者该文档字符串单纯只有一行)接着是一个空行。接着是文档字符串剩下的部分， 它应该与文档字符串的第一行的第一个引号对齐 )</p>
</blockquote>
<ul>
<li>函数和方法</li>
</ul>
<blockquote>
<p>函数必须要有文档字符串，除非它外部不可见、非常短小、简单明了。文档字符串应该包含函数做什么, 以及输入和输出的详细描述</p>
</blockquote>
<p><strong>Args:</strong></p>
<p>列出每个参数的名字, 并在名字后使用一个冒号和一个空格, 分隔对该参数的描述.描述应该包括所需的类型和含义，如果描述太长超过了单行80字符,使用2或者4个空格的悬挂缩进(与文件其他部分保持一致)</p>
<p><strong>Returns: (或者 Yields: 用于生成器)</strong></p>
<p>描述返回值的类型和语义。如果函数返回None, 这一部分可以省略</p>
<p><strong>Raises:</strong></p>
<p>列出与接口有关的所有异常</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fetch_bigtable_rows</span><span class="params">(big_table, keys, other_silly_variable=None)</span>:</span></div><div class="line">    <span class="string">"""Fetches rows from a Bigtable.</span></div><div class="line"></div><div class="line">    Retrieves rows pertaining to the given keys from the Table instance</div><div class="line">    represented by big_table.  Silly things may happen if</div><div class="line">    other_silly_variable is not None.</div><div class="line"></div><div class="line">    Args:</div><div class="line">        big_table: An open Bigtable Table instance.</div><div class="line">        keys: A sequence of strings representing the key of each table row</div><div class="line">        to fetch.</div><div class="line">        other_silly_variable: Another optional variable, that has a much</div><div class="line">        longer name than the other args, and which does nothing.</div><div class="line"></div><div class="line">    Returns:</div><div class="line">        A dict mapping keys to the corresponding table row data</div><div class="line">        fetched. Each row is represented as a tuple of strings. For</div><div class="line">        example:</div><div class="line"></div><div class="line">        &#123;'Serak': ('Rigel VII', 'Preparer'),</div><div class="line">        'Zim': ('Irk', 'Invader'),</div><div class="line">        'Lrrr': ('Omicron Persei 8', 'Emperor')&#125;</div><div class="line"></div><div class="line">        If a key from the keys argument is missing from the dictionary,</div><div class="line">        then that row was not found in the table.</div><div class="line"></div><div class="line">    Raises:</div><div class="line">        IOError: An error occurred accessing the bigtable.Table object.</div><div class="line">    """</div><div class="line">    <span class="keyword">pass</span></div></pre></td></tr></table></figure>
<h3 id="类"><a href="#类" class="headerlink" title="类"></a>类</h3><p>类应该在其定义下有一个用于描述该类的文档字符串。如果你的类有公共属性(Attributes), 那么文档中应该有一个属性(Attributes)段。并且应该遵守和函数参数相同的格式</p>
<pre><code class="python">
<span class="class"><span class="keyword">class</span> <span class="title">SampleClass</span><span class="params">(object)</span>:</span>
    <span class="string">"""Summary of class here.

    Longer class information....
    Longer class information....

    Attributes:
        likes_spam: A boolean indicating if we like SPAM or not.
        eggs: An integer count of the eggs we have laid.
    """</span>

    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, likes_spam=False)</span>:</span>
        <span class="string">"""Inits SampleClass with blah."""</span>
        self.likes_spam = likes_spam
        self.eggs = <span class="number">0</span>

    <span class="function"><span class="keyword">def</span> <span class="title">public_method</span><span class="params">(self)</span>:</span>
        <span class="string">"""Performs operation blah."""</span>
</code></pre>
<blockquote>
<p>如果一个类不继承自其它类, 就显式的从object继承. 嵌套类也一样.</p>
</blockquote>
<h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><ul>
<li>即使参数都是字符串, 使用%操作符或者格式化方法格式化字符串</li>
</ul>
<blockquote>
<p>避免在循环中用+和+=操作符来累加字符串，字符串是不可变的，这样做会创建不必要的临时对象。作为替代方案, 你可以将每个子串加入列表, 然后在循环结束后用 .join 连接列表</p>
</blockquote>
<ul>
<li><p>在同一个文件中, 保持使用字符串引号的一致性(使用单引号’或者双引号”)</p>
</li>
<li><p>为多行字符串使用三重双引号”“”</p>
</li>
</ul>
<h3 id="文件和sockets"><a href="#文件和sockets" class="headerlink" title="文件和sockets"></a>文件和sockets</h3><blockquote>
<p>在文件和sockets结束时, 显式的关闭它，文件使用<code>with</code></p>
</blockquote>
<h3 id="TODO注释"><a href="#TODO注释" class="headerlink" title="TODO注释"></a>TODO注释</h3><blockquote>
<p>为临时代码使用TODO注释</p>
</blockquote>
<p>TODO注释应该在所有开头处包含”TODO”字符串，紧跟着是用括号括起来的你的名字，email地址或其它标识符。然后是一个可选的冒号。接着必须有一行注释，解释要做什么.</p>
<pre><code># TODO(kl@gmail.com): Use a &quot;*&quot; here for string repetition.
# TODO(Zeke) Change this to use relations.
</code></pre><h3 id="导入格式"><a href="#导入格式" class="headerlink" title="导入格式"></a>导入格式</h3><blockquote>
<p>每个导入应该独占一行</p>
</blockquote>
<p>导入总应该放在文件顶部, 位于模块注释和文档字符串之后, 模块全局变量和常量之前. 导入应该按照从最通用到最不通用的顺序分组:</p>
<pre><code>1.标准库导入
2.第三方库导入
3.应用程序指定导入
</code></pre><p>每种分组中, 应该根据每个模块的完整包路径按字典序排序, 忽略大小写.</p>
<pre><code>import foo
from foo import bar
from foo.bar import baz
from foo.bar import Quux
from Foob import ar
</code></pre><h3 id="语句"><a href="#语句" class="headerlink" title="语句"></a>语句</h3><blockquote>
<p>通常每个语句应该独占一行</p>
</blockquote>
<h3 id="访问控制"><a href="#访问控制" class="headerlink" title="访问控制"></a>访问控制</h3><p>在Python中, 对于琐碎又不太重要的访问函数, 你应该直接使用公有变量来取代它们, 这样可以避免额外的函数调用开销. 当添加更多功能时, 你可以用属性(property)来保持语法的一致性.</p>
<p>另一方面, 如果访问更复杂, 或者变量的访问开销很显著, 那么你应该使用像 get_foo() 和 set_foo() 这样的函数调用. 如果之前的代码行为允许通过属性(property)访问 , 那么就不要将新的访问函数与属性绑定. 这样, 任何试图通过老方法访问变量的代码就没法运行, 使用者也就会意识到复杂性发生了变化.</p>
<h3 id="命名"><a href="#命名" class="headerlink" title="命名"></a>命名</h3><blockquote>
<p>`module_name, package_name, ClassName, method_name, ExceptionName, function_name,</p>
<p> GLOBAL_VAR_NAME, instance_var_name, function_parameter_name, local_var_name.`</p>
</blockquote>
<p>应该避免的名称</p>
<ul>
<li>单字符名称, 除了计数器和迭代器</li>
<li>包/模块名中的连字符(-)</li>
<li>双下划线开头并结尾的名称(Python保留, 例如<strong>init</strong>)</li>
</ul>
<p>命名约定</p>
<ul>
<li>用单下划线(_)开头表示模块变量或函数是protected的(使用import * from时不会包含)</li>
<li>用双下划线(__)开头的实例变量或方法表示类内私有</li>
<li>将相关的类和顶级函数放在同一个模块里</li>
<li>对类名使用大写字母开头的单词(如CapWords), 但是模块名应该用小写加下划线的方式(如lower_with_under.py)</li>
</ul>
<h3 id="Main"><a href="#Main" class="headerlink" title="Main"></a>Main</h3><p>执行主程序前总是检查 <code>if __name__ == &#39;__main__&#39;</code></p>
<pre><code>def main():
  ...

if __name__ == &apos;__main__&apos;:
    main()
</code></pre><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="http://zh-google-styleguide.readthedocs.io/en/latest/google-python-styleguide/python_style_rules/" target="_blank" rel="external">Google 开源项目风格指南</a></p>
</div></article><div class="tags"><a href="/tags/Python/">Python</a></div><div class="paginator"><a href="/2016/11/01/跨仓库转移SVN代码目录/" class="prev"><i class="iconfont icon-left"></i><span> Prev</span></a><a href="/2016/06/16/ss/" class="next"><span>Next</span><i class="iconfont icon-right"></i></a></div><section id="comments"><div id="disqus_thread"></div></section><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'http://yoursite.com/2016/10/29/Python编码风格/';
    this.page.identifier = '2016/10/29/Python编码风格/';
    this.page.title = 'Python编码风格';
};
(function() {
var d = document, s = d.createElement('script');

s.src = '//Your disqus ID.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();</script></section><footer><div class="social"><a href="https://github.com/Abnerzhao" title="github" class="iconfont icon-github"></a><a href="mailto:opsabnerzhao@gmail.com" title="email" class="iconfont icon-email"></a><a href="http://weibo.com/2863179107/profile?topnav=1&amp;wvr=6&amp;is_all=1" title="weibo" class="iconfont icon-weibo"></a></div><div class="copyright"><p class="power">Powered by <a href="https://hexo.io/">Hexo</a> and Theme by <a href="https://github.com/ahonn/hexo-theme-even"> Even</a></p><p class="since">&copy;2015-2016<span class="heart"><i class="iconfont icon-heart"></i></span><span class="author">Abnerzhao</span></p></div><div id="back2top"><i class="iconfont icon-up"></i></div></footer></div><script src="/js/zepto.min.js"></script><script src="/js/theme.js"></script></body></html>