<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Abnerzhao</title><meta name="description" content="DevOps"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="Abnerzhao"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link active">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://abnerzhao.readthedocs.io/" target="_blank" class="nav-list-link">WIKI</a></li><li class="nav-list-item"><a href="https://github.com/Abnerzhao" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li></ul></header><main class="container"><ul class="home post-list"><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/04/05/douban-spider/" class="post-title-link">豆瓣房源爬虫小记</a></h2><div class="post-info">Apr 5, 2018</div><div class="post-content"><p>最近又要开始找房，来上海三年不到已经是第三次搬家，真是居大不易。现在住的房子是在豆瓣小组上找的，豆瓣上个人房源较多，但是豆瓣小组没有对房源信息进行分类，找起来比较费时，索性写了个简单的爬虫，根据关键字来找房。网上也有一些现成的代码实现，想着还是自己实践一下。</p>
<p>Python 新手上路…</p>
<h3 id="获取豆瓣房源小组链接"><a href="#获取豆瓣房源小组链接" class="headerlink" title="获取豆瓣房源小组链接"></a>获取豆瓣房源小组链接</h3><p>先搜索一下上海的租房小组</p>
<p><img src="http://7vzmp5.com1.z0.glb.clouddn.com/270B4257-2781-4F04-A000001F-A539B7F1791D.png" alt=""></p>
<p>找几个人数较多和活跃度高的小组，进入小组讨论页面，观察 URL 的规律。<br></div><a href="/2018/04/05/douban-spider/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/03/25/celery-background/" class="post-title-link">Celery 后台执行方法</a></h2><div class="post-info">Mar 25, 2018</div><div class="post-content"><h3 id="init-script"><a href="#init-script" class="headerlink" title="init-script"></a>init-script</h3><p>1.先下载两个脚本文件 <a href="https://github.com/celery/celery/tree/3.1/extra/generic-init.d/">generic-init.d</a>，我的项目里有定时任务，所以两个都需要用到</p>
<p>2.创建配置文件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ cat /etc/default/celeryd</div><div class="line"># Names of nodes to start</div><div class="line">#   most people will only start one node:</div><div class="line"></div><div class="line">CELERYD_NODES=&quot;worker1&quot; # work 任务节点</div><div class="line"></div><div class="line">#   but you can also start multiple and configure settings</div><div class="line">#   for each in CELERYD_OPTS</div><div class="line">#CELERYD_NODES=&quot;worker1 worker2 worker3&quot;</div><div class="line">#   alternatively, you can specify the number of nodes to start:</div><div class="line">#CELERYD_NODES=10</div><div class="line"></div><div class="line"># Absolute or relative path to the &apos;celery&apos; command:</div><div class="line"></div><div class="line">CELERY_BIN=&quot;/home/prod/softwares/python/bin/celery&quot; # celery 命令的绝对路径</div><div class="line"></div><div class="line"># App instance to use</div><div class="line"># comment out this line if you don&apos;t use an app</div><div class="line"></div><div class="line">CELERY_APP=&quot;wfstar&quot; # 应用实例</div><div class="line"></div><div class="line"># or fully qualified:</div><div class="line">#CELERY_APP=&quot;proj.tasks:app&quot;</div><div class="line"></div><div class="line"># Where to chdir at start.</div><div class="line">CELERYD_CHDIR=&quot;/home/prod/deploys/wfstar&quot; # 项目目录</div><div class="line"></div><div class="line"># Extra command-line arguments to the worker</div><div class="line"></div><div class="line">CELERYD_OPTS=&quot;--time-limit=300 --concurrency=8&quot; # 命令行参数，更多请参考 man 手册 </div><div class="line"></div><div class="line"># Configure node-specific settings by appending node name to arguments:</div><div class="line">#CELERYD_OPTS=&quot;--time-limit=300 -c 8 -c:worker2 4 -c:worker3 2 -Ofair:worker1&quot;</div><div class="line"># Set logging level to DEBUG</div><div class="line">#CELERYD_LOG_LEVEL=&quot;DEBUG&quot;</div><div class="line"></div><div class="line"># %n will be replaced with the first part of the nodename</div><div class="line"></div><div class="line">CELERYD_LOG_FILE=&quot;/var/log/celery/%n%I.log&quot;</div><div class="line">CELERYD_PID_FILE=&quot;/var/run/celery/%n.pid&quot;</div><div class="line"></div><div class="line"># Workers should run as an unprivileged user.</div><div class="line">#   You need to create this user manually (or you can choose</div><div class="line">#   a user/group combination that already exists (e.g., nobody).</div><div class="line"></div><div class="line">CELERYD_USER=&quot;prod&quot;</div><div class="line">CELERYD_GROUP=&quot;prod&quot;</div><div class="line"></div><div class="line"># If enabled pid and log directories will be created if missing,</div><div class="line"># and owned by the userid/group configured.</div><div class="line">CELERY_CREATE_DIRS=1  # 自动创建日志和 pid 文件</div></pre></td></tr></table></figure></div><a href="/2018/03/25/celery-background/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2018/02/25/django-celery-notes/" class="post-title-link">Django Celery 定时任务笔记</a></h2><div class="post-info">Feb 25, 2018</div><div class="post-content"><h3 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h3><ul>
<li>Python 2.7</li>
<li>Djang 1.10</li>
<li>celery 4.1.0</li>
<li>RabbitMQ 3.2.4</li>
</ul>
<h3 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h3><h4 id="创建虚拟环境，构建-Django-项目"><a href="#创建虚拟环境，构建-Django-项目" class="headerlink" title="创建虚拟环境，构建 Django 项目"></a>创建虚拟环境，构建 Django 项目</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ virtualenv django-exp</div><div class="line">$ source django-exp/bin/activate</div><div class="line">$ pip intall django==1.10</div><div class="line">$ django-admin startproject myproject</div><div class="line">$ cd myproject/</div><div class="line">$ django-admin startapp myapp</div><div class="line">$ tree</div><div class="line">.</div><div class="line">├── manage.py</div><div class="line">├── myapp</div><div class="line">│   ├── admin.py</div><div class="line">│   ├── apps.py</div><div class="line">│   ├── __init__.py</div><div class="line">│   ├── migrations</div><div class="line">│   │   └── __init__.py</div><div class="line">│   ├── models.py</div><div class="line">│   ├── tests.py</div><div class="line">│   └── views.py</div><div class="line">└── myproject</div><div class="line">    ├── __init__.py</div><div class="line">    ├── settings.py</div><div class="line">    ├── urls.py</div><div class="line">    └── wsgi.py</div><div class="line">$ pip install celery</div><div class="line">$ pip install pysqlite</div><div class="line">$ sudo apt-get install rabbitmq-server</div></pre></td></tr></table></figure></div><a href="/2018/02/25/django-celery-notes/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/12/02/2017年11月读书总结/" class="post-title-link">十一月读书总结</a></h2><div class="post-info">Dec 2, 2017</div><div class="post-content"><p>十一月份看了两本东野圭吾的书，心仪已久的「解忧杂货店」和暖心的「时生」。这两本书其实很不东野圭吾，不悬疑也不推理，而是如这冬日里一杯热咖啡。另外还看了两本关于自我管理的书，「时间管理：如何充分利用你的24小时」、「毅力：如何培养自律的习惯」。这两本书篇幅很短形式新颖，准确来说是漫画书，两节课的时间就能看完，其实就是看了两节课的PPT…</p></div><a href="/2017/12/02/2017年11月读书总结/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/10/14/quickstart-wiki/" class="post-title-link">使用Sphinx + GitHub + Read the Docs搭建wiki</a></h2><div class="post-info">Oct 14, 2017</div><div class="post-content"><p>Sphinx 是一个基于 ReStructuredText 的文档生成工具，有很多开源工程都采用sphinx作为文档生成系统，最有名的就是 python 官方文档。</p>
<p>Read the Docs是一个在线文档托管服务，可以从各种版本控制系统中导入文档。支持 webhooks，当你提交代码时，文档将被自动构建。</p>
<p>Sphinx + GitHub + ReadtheDocs 作为一个文档写作工具， 用 Sphinx 生成文档，GitHub 托管文档，再导入到 ReadtheDocs。我们可以使用这个工具写文档、记笔记等。</p>
<h3 id="搭建过程"><a href="#搭建过程" class="headerlink" title="搭建过程"></a>搭建过程</h3><h4 id="安装-Sphinx"><a href="#安装-Sphinx" class="headerlink" title="安装 Sphinx"></a>安装 Sphinx</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ sudo pip install sphinx</div></pre></td></tr></table></figure></div><a href="/2017/10/14/quickstart-wiki/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/09/26/python-torndb/" class="post-title-link">Python Torndb 简单使用</a></h2><div class="post-info">Sep 26, 2017</div><div class="post-content"><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p><a href="http://torndb.readthedocs.io/en/latest/">官方文档</a>释义：</p>
<blockquote>
<p>A lightweight wrapper around MySQLdb.<br>Originally part of the Tornado framework. The tornado.database module is slated for removal in Tornado 3.0, and it is now available separately as torndb.</p>
</blockquote>
<p>torndb 是一个基于 MySQLdb 封装的轻量级模块。</p>
<p>进一步了解请阅读源码：<a href="https://github.com/bdarnell/torndb">GitHub 源码地址</a></p>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ pip install torndb</div></pre></td></tr></table></figure></div><a href="/2017/09/26/python-torndb/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/09/04/set-up-svn-server/" class="post-title-link">Ubuntu 14.04 SVN 服务快速搭建</a></h2><div class="post-info">Sep 4, 2017</div><div class="post-content"><h3 id="软件包安装"><a href="#软件包安装" class="headerlink" title="软件包安装"></a>软件包安装</h3><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ sudo apt-get install subversion apache2 libapache2-svn apache2-utils</div></pre></td></tr></table></figure>
<h3 id="创建仓库目录"><a href="#创建仓库目录" class="headerlink" title="创建仓库目录"></a>创建仓库目录</h3><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ sudo mkdir -p /home/abner/svn</div><div class="line">$ sudo svnadmin create /home/abner/svn/test_project</div><div class="line">$ sudo svnadmin create /home/abner/svn/ops</div><div class="line">$ sudo chown -R www-data:www-data /home/abner/svn</div></pre></td></tr></table></figure>
<h3 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h3><p><code>/etc/apache2/mods-available/dav_svn.conf</code> 文件末尾添加如下配置：<br></div><a href="/2017/09/04/set-up-svn-server/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/08/02/How-to-use-strings-to-call-functions-or-methods/" class="post-title-link">通过字符串调用函数或方法</a></h2><div class="post-info">Aug 2, 2017</div><div class="post-content"><p>先看一个例子：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">&gt;&gt;&gt; def foo():</div><div class="line">        print &quot;foo&quot;</div><div class="line"></div><div class="line">&gt;&gt;&gt; def bar():</div><div class="line">        print &quot;bar&quot;</div><div class="line"></div><div class="line">&gt;&gt;&gt; func_list = [&quot;foo&quot;,&quot;bar&quot;]</div><div class="line">&gt;&gt;&gt; for func in func_list:</div><div class="line">        func()</div><div class="line">TypeError: &apos;str&apos; object is not callable</div></pre></td></tr></table></figure></div><a href="/2017/08/02/How-to-use-strings-to-call-functions-or-methods/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/07/15/summer-s2/" class="post-title-link">那年夏天（二）</a></h2><div class="post-info">Jul 15, 2017</div><div class="post-content"><p>火车缓缓始离站台，窗外城市光影在雨水中渐渐模糊。半个多月的穷游之旅也划上了句号。始于昆明止于成都，记得刚到昆明时还有将近百来号人，而如今返程只有我和好基友两人。原计划在川渝逗留一阵，但是成都连续阴雨已让我们兴致全无。本以为自己根本就不会想家，但是冒雨走在成都街头的那一刻，我承认我想家了。天色渐暗，我想今晚我可能要失眠了，这一路上经历的片段不断浮现在我脑海，险境和绝美的风景让我内心不能平静，有趣的人和故事让我难以忘怀，火车疾驰穿过黑暗，天亮以后抵达的终点更让我难以入眠……</p>
<h3 id="踏上征途"><a href="#踏上征途" class="headerlink" title="踏上征途"></a>踏上征途</h3><p>硬座了二十多个小时的绿皮火车，从东南丘陵到云贵高原，最终抵达春城昆明。在昆明只停留了两天，搭帐篷睡在一个学校食堂里。正值暑期，学校已空无一人，组织者事先和校方沟通过，所以水电还是能够正常使用。在昆明发了半天传单赚了一顿过桥米线，后续时间就和小伙伴去了滇池、陆军讲武堂和云南大学。值得称道的是云大的食堂，超级便宜味道也不错，为了省钱去云大吃了几顿。昆明的确是四季如春，虽是夏季却从不需要空调。不时几朵棉花糖般的白云飘过湛蓝的天空，阳光从树影穿过洒在身上，我还是被这高原的紫外线分分钟晒红了。</p>
<p>昆明到大理，全程三百多公里。计划是用一天的时间到达大理。顺利的话全程高速也就四个多小时的样子。第一次搭车真的非常有趣，我和两位女生一行。说实话我简直沾尽了她们俩的光。我们计划先在市区搭车到高速入口，然后在往大理方向的路口拦顺风车。在高速路口，俩女生很快就拦到直达大理的顺风车还是很高端的顺风车。托她俩的福我人生第一次坐奔驰。奔驰哥是浙江人在云南做房地产生意，由于从昆明到大理要四个小时，他空车一人驾驶想找人聊聊天所以就拉上我们了。结果俩女生上车后倒头就睡，只剩我和奔驰哥再聊。奔驰哥人很友善随和，一路上各种嘘寒问暖各种关怀。傍晚时分，我们顺利到达了淅淅沥沥的雨中大理。<br></div><a href="/2017/07/15/summer-s2/" class="read-more">...more</a></article></li><li class="post-list-item"><article class="post-block"><h2 class="post-title"><a href="/2017/07/08/summer-s1/" class="post-title-link">那年夏天（一）</a></h2><div class="post-info">Jul 8, 2017</div><div class="post-content"><p>最近午休时间总能听到树上聒噪的阵阵蝉鸣，晚上夜跑也有此起彼伏的蛙声相伴。转眼间，人生的第二十四个春夏已到来。一年四季中说不上特别喜欢夏天，但是对于夏天总有一些特别的情感和记忆。</p>
<p>夏天可以和小伙伴们肆无忌惮地玩水嬉戏，抱着冰西瓜吹风扇看电视，快速舔着渐渐融化的冰淇淋。特别喜欢凉爽的夏夜，明朗的星空下一家人在院内乘凉，远处池塘蛙声不断，耳畔徐来夏夜凉风和外婆年轻时的故事。</p>
<p>夏天有漫长慵懒的暑假。计划生育让我成为了独生子女，改革开放使我成为留守儿童的同时也让我拥有了不一样的暑期。印象中暑假去得最多的地方应该就数深圳了。坐着通宵的绿皮火车却没有一丝疲倦，内心更多的是欢喜和期待。小的时候就特别喜欢火车，大姨家就在湘江边，每天都有红色和绿色的火车来回跨江而过，而我最喜欢做的事情就是远远的望着火车轰鸣而过并数它的节数，直到现在还有这种火车情节，因为我知道它代表着远方。每次去深圳都是到舅舅家，一来是舅舅家有两个小孩即我表妹和表弟，年纪相仿从小青梅竹马一起长大，所以都是一起玩，二来我也没有其他地方可以去。嘈杂的市场、熙攘的人流、糅杂着鱼腥和卤味的空气、网吧CS、欢乐谷、大梅沙、还有那条植被茂密宽广的深南大道构成了我对深圳的全部记忆。我相信深圳这个地名会根植在几代人的记忆中，无论是淘金者还是像我们这样的留守儿童。</p>
<p>还有一件人生比较重大的事也发生在夏季那就是毕业。以前并不觉得毕业是件重大的事，只不过是按部就班地完成学业而已。现在看来每次毕业都是一次重大地选择，选择去哪座城市哪个学校完成下一阶段的学习。通过一次次的毕业，我从乡村到县城到市区再到上海。依稀记得我的高考第一志愿是沈阳理工大学，当时只有一个想法那是离家越远越好。我和两位要好的朋友都填了这所大学，现在想来还有点儿戏。最终我差四分留在了省内，另两位朋友都被录取了，但是只有一位去了北方，另一位复读了。高中毕业还是挺难忘了，毕竟都天真地以为彻底解放了。其实高中生活也没那么苦，更多的是充实和忙碌。说实话还挺怀念那段青葱岁月的，可能是因为那时有一群朋友为共同的目标奋斗着，而如今在陌生的繁华都市里却朋友寥寥。大学毕业则很轻松愉快，除了偶尔缅怀校园生活，伤感青春易逝之外，更多的是对未来人生的憧憬。</p></div><a href="/2017/07/08/summer-s1/" class="read-more">...more</a></article></li></ul></main><footer><div class="paginator"><a href="/page/2/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2018 <a href="http://yoursite.com">Abnerzhao</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>