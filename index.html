<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="Abnerzhao"><meta name="description" content="DevOps"><title>Abner</title><link rel="icon" href="/favicon.ico"><link rel="canonical" href="http://yoursite.com/"><link rel="alternate" href="/atom.xml" title="Abner"><link rel="stylesheet" href="/fonts/iconfont/iconfont.css"><link rel="stylesheet" href="/css/style.css"><script type="text/javascript">var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?5832f612aff8681e2ee213a3b8d9548b";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script type="text/javascript">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'Your Google Analytics ID', 'auto');
ga('send', 'pageview');</script></head><body><div id="main"><header><a href="/." class="logo">Abner</a><ul class="nav"><li class="nav-link"><a href="/" class="active">Home</a></li><li class="nav-link"><a href="/archives/" target="_self">Archives</a></li><li class="nav-link"><a href="/categories/" target="_self">Categories</a></li><li class="nav-link"><a href="/about/" target="_self">About</a></li></ul></header><section id="container"><ul class="home"><li class="post-item"><article class="post"><h2 class="post-title"><a href="/2017/05/06/ssh-config/" class="post-link">ssh config 配置小技巧</a></h2><span class="post-time">May 6, 2017</span><div class="post-content"><p>自己弄了台aws云主机，每次登陆需要指定pem文件，用户名和主机名(或ip)，感觉挺麻烦的。通过ssh配置文件可以偷个懒。</p>
<h3 id="ssh-config"><a href="#ssh-config" class="headerlink" title="ssh_config"></a>ssh_config</h3><p>通过 ssh_config man手册我们知道对于ssh client进行远程连接可以用命令行指定参数也可以通过配置文件来设置。</p>
<ul>
<li>command-line options</li>
<li>user’s configuration file (~/.ssh/config)</li>
<li>system-wide configuration file (/etc/ssh/ssh_config)</li>
</ul>
<p>~/.ssh/config这个文件是针对某个用户，/etc/ssh/ssh_config是针对所有系统用户。两者配置语法结构相同。</p>
<p>简单编辑~/.ssh/config文件<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ cat .ssh/config</div><div class="line">Host myaws</div><div class="line">    User ubuntu</div><div class="line">    HostName ec2-xx-xxx-xxx-xx.ap-southeast-1.compute.amazonaws.com</div><div class="line">    IdentityFile  ~/.ssh/my.pem</div></pre></td></tr></table></figure></p>
<p>登陆主机<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ ssh myaws</div><div class="line">之前的登录方式：</div><div class="line">$ ssh -i ~/.ssh/my.pem ubuntu@ec2-xx-xxx-xxx-xx.ap-southeast-1.compute.amazonaws.com</div></pre></td></tr></table></figure></p>
<p>除了基本的用户名、主机、key文件，在~/.ssh/config文件当中我们还可以指定端口，配置ProxyCommand等</p>
<h3 id="ProxyCommand"><a href="#ProxyCommand" class="headerlink" title="ProxyCommand"></a>ProxyCommand</h3><p>ProxyCommand指定一个命令通过shell来执行</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">$ cat .ssh/config</div><div class="line">Host 172.31.*.*</div><div class="line">    User ubuntu</div><div class="line">    ProxyCommand ssh proxyuser@proxyip -p 22 nc %h %p 2&gt; /dev/null</div><div class="line">    StrictHostKeyChecking no</div><div class="line">    ServerAliveInterval    60</div><div class="line">    TCPKeepAlive           yes</div><div class="line">    ControlPersist         30m</div><div class="line">Host 10.10.0.*</div><div class="line">    User ubuntu</div><div class="line">    ProxyCommand ssh -p 55552 proxyuser@proxyip nc %h %p 2&gt; /dev/null</div><div class="line">    StrictHostKeyChecking no</div><div class="line">    ServerAliveInterval    60</div><div class="line">    TCPKeepAlive           yes</div></pre></td></tr></table></figure>
<p>当我们ssh连接 173.31.x.x和10.10.0.x时，实际上是通过proxy去连接的。通过nc命令进行通信，%h表示远程主机，%p表示端口。ProxyCommand还可以实现https代理更多信息请参考ssh_config man帮助。</p>
</div></article></li><li class="post-item"><article class="post"><h2 class="post-title"><a href="/2017/04/11/ansible-callback-plugins/" class="post-link">Ansible 回调插件简单使用</a></h2><span class="post-time">Apr 11, 2017</span><div class="post-content"><h2 id="Developing-Plugins"><a href="#Developing-Plugins" class="headerlink" title="Developing Plugins"></a>Developing Plugins</h2><p>插件是增强ansible核心功能的代码片段，我们可以很方便的使用插件，编写插件代码。如果我们想要对ansible的执行结果进行分析，根据返回结果发送邮件，写入日志等都可以通过插件实现。</p>
<h3 id="插件列表"><a href="#插件列表" class="headerlink" title="插件列表"></a>插件列表</h3><ul>
<li><strong>Action plugins</strong> are front ends to modules and can execute actions on the controller before calling the modules themselves.（操作插件，调用模块之前执行操作）</li>
<li><strong>Cache plugins</strong> are used to keep a cache of ‘facts’ to avoid costly fact-gathering operations.（缓存插件，缓存主机facts变量）</li>
<li><strong>Callback plugins</strong> enable you to hook into Ansible events for display or logging purposes.（回调插件，对事件进行显示和记录，这个常用）</div><a href="/2017/04/11/ansible-callback-plugins/" class="read-more">Read more..</a></article></li><li class="post-item"><article class="post"><h2 class="post-title"><a href="/2017/03/05/Python正则表达式/" class="post-link">Python正则表达式</a></h2><span class="post-time">Mar 5, 2017</span><div class="post-content"><p><strong>正则表达式是一些由字符和特殊符号组成的字符串，它们描􏰀述了这些字符和字符的某种重复方式，因此能按某种模式匹配一个有相似特征的字符串的集合。</strong>正则表达式为高级文本模式匹配，以及搜索-替代等功能􏰁供了基础。</p>
<h2 id="元字符"><a href="#元字符" class="headerlink" title="元字符"></a>元字符</h2><p>元字符是正则表达式中规定的特殊代码，有特定的含义和匹配效果</p>
<p><strong>常用的元字符</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">代码</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">.</td>
<td style="text-align:left">匹配除换行符以外的任意字符</td>
</tr>
<tr>
<td style="text-align:left">\w</td>
<td style="text-align:left">匹配字母或数字或下划线或汉字</td>
</tr>
<tr>
<td style="text-align:left">\s</td>
<td style="text-align:left">匹配任意的空白符(包括空格，制表符(Tab)，换行符，中文全角空格等)</td>
</tr>
<tr>
<td style="text-align:left">\d</td>
<td style="text-align:left">匹配数字</td>
</tr>
<tr>
<td style="text-align:left">\b</td>
<td style="text-align:left">匹配单词的开始或结束(空格、标点、换行都算是单词的分割)</td>
</tr>
<tr>
<td style="text-align:left">^</td>
<td style="text-align:left">匹配字符串的开始</td>
</tr>
<tr>
<td style="text-align:left">$</td>
<td style="text-align:left">匹配字符串的结束</td>
</tr>
</tbody>
</table></div><a href="/2017/03/05/Python正则表达式/" class="read-more">Read more..</a></article></li><li class="post-item"><article class="post"><h2 class="post-title"><a href="/2017/02/16/ansilbe-vars-and-template/" class="post-link">ansible vars变量和templates jinja2渲染</a></h2><span class="post-time">Feb 16, 2017</span><div class="post-content"><h3 id="Ansible-roles"><a href="#Ansible-roles" class="headerlink" title="Ansible roles"></a>Ansible roles</h3><p>Ansible roles用于层次性、结构化地组织playbook，简单介绍一下ansible playbook中关于变量的两个roles目录。</p>
<ul>
<li>vars目录：用于定义此角色用到的变量</li>
<li>templates目录：template模块会自动在此目录中寻找Jinja2模板文件</li>
</ul></div><a href="/2017/02/16/ansilbe-vars-and-template/" class="read-more">Read more..</a></article></li><li class="post-item"><article class="post"><h2 class="post-title"><a href="/2017/01/21/low-level-discovery/" class="post-link">Zabbix Low-level discovery</a></h2><span class="post-time">Jan 21, 2017</span><div class="post-content"><blockquote>
<p>Low-level discovery provides a way to automatically create items, triggers, and graphs for different entities on a computer. For instance, Zabbix can automatically start monitoring file systems or network interfaces on your machine, without the need to create items for each file system or network interface manually. </p>
<p>In Zabbix, four types of item discovery are supported out of the box:</p>
<ul>
<li>discovery of file systems;</li>
<li>discovery of network interfaces;</li>
<li>discovery of CPUs and CPU cores;</li>
<li>discovery of SNMP OIDs.</li>
</ul>
<p>A user can define their own types of discovery, provided they follow a particular JSON protocol.</p>
</blockquote></div><a href="/2017/01/21/low-level-discovery/" class="read-more">Read more..</a></article></li><li class="post-item"><article class="post"><h2 class="post-title"><a href="/2016/11/27/python-excel/" class="post-link">Python xlrd和xlwt表格处理</a></h2><span class="post-time">Nov 27, 2016</span><div class="post-content"><h2 id="表格处理模块"><a href="#表格处理模块" class="headerlink" title="表格处理模块"></a>表格处理模块</h2><ul>
<li>xlwt (writing xls files)</li>
<li>xlrd (reading xls/xlsx files)</li>
<li>openpyxl (reading/writing xlsx files)</li>
<li>xlsxwriter (writing xlsx files)</li>
</ul>
<h2 id="xlrd"><a href="#xlrd" class="headerlink" title="xlrd"></a>xlrd</h2><h3 id="excel表格示例"><a href="#excel表格示例" class="headerlink" title="excel表格示例"></a>excel表格示例</h3><p>示例表格2016-11-27.xlsx 内容如下：</p></div><a href="/2016/11/27/python-excel/" class="read-more">Read more..</a></article></li><li class="post-item"><article class="post"><h2 class="post-title"><a href="/2016/11/16/python-datetime/" class="post-link">Python datetime那点事</a></h2><span class="post-time">Nov 16, 2016</span><div class="post-content"><p>关于datetime时间操作在日常工作中也没有经常用到，但是每次要用时却又想不起来，与其重复查文档不如总结一下备忘。本文只简单记录了常用的一些方法，不同类型格式之间的转换(如时间对象类型、字符串、timestamp、time tuple类型）以及时区问题等暂未深入了解。</p>
<h2 id="datetime模块"><a href="#datetime模块" class="headerlink" title="datetime模块"></a>datetime模块</h2><p>datetime 模块主要用来操作日期和时间</p>
<h3 id="date日期对象"><a href="#date日期对象" class="headerlink" title="date日期对象"></a>date日期对象</h3><figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> datetime</div><div class="line"></div><div class="line"><span class="keyword">print</span> datetime.date.today()  //返回当前本地日期</div><div class="line"><span class="keyword">print</span> datetime.date(<span class="number">2016</span>,<span class="number">11</span>,<span class="number">16</span>) //生成日期对象</div><div class="line"></div><div class="line">//stdout</div><div class="line"><span class="number">2016</span><span class="number">-11</span><span class="number">-16</span></div><div class="line"><span class="number">2016</span><span class="number">-11</span><span class="number">-16</span></div></pre></td></tr></table></figure></div><a href="/2016/11/16/python-datetime/" class="read-more">Read more..</a></article></li><li class="post-item"><article class="post"><h2 class="post-title"><a href="/2016/11/04/ansible-python-api/" class="post-link">小试Ansible Python API</a></h2><span class="post-time">Nov 4, 2016</span><div class="post-content"><h2 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h2><h3 id="命令行"><a href="#命令行" class="headerlink" title="命令行"></a>命令行</h3><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">// ping 模块</div><div class="line">$ ansible localhost -m ping</div><div class="line">localhost | success &gt;&gt; &#123;</div><div class="line">    &quot;changed&quot;: false,</div><div class="line">    &quot;ping&quot;: &quot;pong&quot;</div><div class="line">&#125;</div><div class="line">// shell 模块</div><div class="line">$ ansible localhost -m shell -a &apos;uptime&apos;</div><div class="line">localhost | success | rc=0 &gt;&gt;</div><div class="line">11:00:11 up 66 days, 23:34,  1 user,  load average: 0.00, 0.01, 0.05</div></pre></td></tr></table></figure>
<h3 id="Python-API"><a href="#Python-API" class="headerlink" title="Python API"></a>Python API</h3><p>通过ansible.runner模块来实现</p></div><a href="/2016/11/04/ansible-python-api/" class="read-more">Read more..</a></article></li><li class="post-item"><article class="post"><h2 class="post-title"><a href="/2016/11/01/svn-code-transfer/" class="post-link">跨仓库转移SVN代码目录</a></h2><span class="post-time">Nov 1, 2016</span><div class="post-content"><p>由于公司先前代码管理比较混乱，不同部门之间的代码有放在同一个仓库的，抽空转移了部分并记录备忘。</p>
<p><strong>project项目位于dev仓库的主分支，现需要将他转移到ops仓库主分支</strong></p>
<blockquote>
<p>old svn: <a href="http://svnserver/svn/dev/trunk/project/">http://svnserver/svn/dev/trunk/project/</a></p>
<p>new svn:<a href="http://svnserver/svn/ops/trunk/">http://svnserver/svn/ops/trunk/</a></p>
</blockquote>
<p><strong>直接svn move 报错：</strong></p>
<pre><code>$ svn move  http://svnserver/svn/dev/trunk/project/  http://svnserver/svn/ops/trunk/
svn: E200007: Source and destination URLs appear not to point to the same repository.
</code></pre><blockquote>
<p>svn: E200007: Source and destination URLs appear not to point to the same repository. </p>
<p>不同的仓库之间无法直接move或cp项目代码</p>
</blockquote></div><a href="/2016/11/01/svn-code-transfer/" class="read-more">Read more..</a></article></li><li class="post-item"><article class="post"><h2 class="post-title"><a href="/2016/09/18/python-dict-list-sort/" class="post-link">Python字典排序和列表去重</a></h2><span class="post-time">Sep 18, 2016</span><div class="post-content"><h2 id="字典排序"><a href="#字典排序" class="headerlink" title="字典排序"></a>字典排序</h2><h3 id="字典key排序"><a href="#字典key排序" class="headerlink" title="字典key排序"></a>字典key排序</h3><p>方法一：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">dict = &#123;&apos;b&apos;:3,&apos;a&apos;:1,&apos;d&apos;:7,&apos;c&apos;:5&#125;</div><div class="line">items = dict.items()</div><div class="line">items.sort()</div><div class="line"></div><div class="line">print [(k,v) for k,v in items] //[(&apos;a&apos;, 1), (&apos;b&apos;, 3), (&apos;c&apos;, 5), (&apos;d&apos;, 7)]</div></pre></td></tr></table></figure></div><a href="/2016/09/18/python-dict-list-sort/" class="read-more">Read more..</a></article></li></ul><div class="paginator"><a href="/page/2/" class="next"><span>Next</span><i class="iconfont icon-right"></i></a></div></section><footer><div class="social"><a href="https://github.com/Abnerzhao" title="github" class="iconfont icon-github"></a><a href="mailto:opsabnerzhao@gmail.com" title="email" class="iconfont icon-email"></a><a href="http://weibo.com/2863179107/profile?topnav=1&amp;wvr=6&amp;is_all=1" title="weibo" class="iconfont icon-weibo"></a></div><div class="copyright"><p class="power">Powered by <a href="https://hexo.io/">Hexo</a> and Theme by <a href="https://github.com/ahonn/hexo-theme-even"> Even</a></p><p class="since">&copy;2015-2017<span class="heart"><i class="iconfont icon-heart"></i></span><span class="author">Abnerzhao</span></p></div><div id="back2top"><i class="iconfont icon-up"></i></div></footer></div><script src="/js/zepto.min.js"></script><script src="/js/theme.js"></script></body></html>